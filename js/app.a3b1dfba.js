(function(t){function e(e){for(var n,s,o=e[0],l=e[1],c=e[2],h=0,d=[];h<o.length;h++)s=o[h],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&d.push(a[s][0]),a[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(d.length)d.shift()();return r.push.apply(r,c||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],n=!0,o=1;o<i.length;o++){var l=i[o];0!==a[l]&&(n=!1)}n&&(r.splice(e--,1),t=s(s.s=i[0]))}return t}var n={},a={app:0},r=[];function s(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=n,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/dmriprep-viewer/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"00e5":function(t,e,i){"use strict";i("ed29")},"034f":function(t,e,i){},"034fb":function(t,e,i){"use strict";i("85ec")},"071c":function(t,e,i){},"183b":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sHDgwCEMBJZu0AAAAdaVRYdENvbW1lbnQAAAAAAENyZWF0ZWQgd2l0aCBHSU1QZC5lBwAABM5JREFUWMO1V0tPG2cUPZ4Hxh6DazIOrjFNqJs0FIMqWFgWQkatsmvVbtggKlSVRVf5AWz4AWz4AUSKEChll19QJYSXkECuhFxsHjEhxCYm+DWGMZ5HF72DJq4bAzFXurI0M/I5997v3u9cC65vTJVn2lX/xHINQOYSBLTLEuIuCWw4Z3IGAEvf6ASmVHjNzHCXBG4A0AjACsAOwEbO0nsFQBnAGYASAIl+ZRMR7SolMEdsByD09fV5R0ZGgg8ePPjW5/N1iqLYpuu6RZblciKR2I9Go69evnwZnZ+fjwI4IS8AKBIRzeQfJWCANwKwh0KhtrGxsYehUOin1tbW+zzP23ietzY2NnIAoGmaLsuyUiqVyvl8XtrY2NiamZn589mzZxsAUgCOAeQAnFI2tI+VxIjaAeDzoaGh7xYWFuZOTk6OZVk+12uYqqq6JEnn0Wg0OT4+/geAXwGEAdwDIFJQXC1wO4DWR48e/RCPxxclSSroVzRFUbSDg4P848ePFwH8DuAhkWih83TRQWxFOXgAwvDwcOfo6OhvXV1d39tsNtuVBwTDWBwOh1UUxVsMw1hXVlbSdCgNV43uYSvrHg6H24aHh38eHBz85TrgF9FYLHA4HLzH43FvbW2d7u/vG+dANp8FpqIlbd3d3V8Fg8EfBUFw4BONZVmL3+9vHhkZCQL4AoAHgJPK8G+yzC0XDofdoVAo5PP5vkadTBAEtr+/39ff3x8gAp/RPOEqx2qjx+NpvXv3bk9DQ0NDvQgwDIOWlhZrMBj8kgi0UJdxRgYMArzL5XJ7vd57qLPZ7Xamp6fnNgBXtQxcjFuHw+Hyer3t9SYgCAITCAScAJoBNNEY/08GOFVVrfVMv7kMNDntFD1vjIAPrlRN0xjckOm6biFQ3jwNPwDMZrOnqVTqfb3Bi8Wivru7W/VCYkwPlKOjo0IikXh7EwQikYgE4Nw0CfXKDCipVCoTj8df3QABbW1tLUc6oUgkFPMkVACUNjc337148eKvw8PDbJ2jP1taWkoCyNDVXDSECmNSK4qiKNLq6urW8+fPI/UicHx8rD59+jSVy+WOAKSJhKENwFItLtoxk8mwsixzHR0dHe3t7c5PAU+n09rs7OzJkydPYqVSaQfANoDXALIk31S2smU1TWMPDg7K5XKZ7+3t9TudTut1U7+wsFCcmJiIpdPpbQBxADsAknQWymYCOukBHYCuKApisdhpMpnURFEU79y503TVyKenpzOTk5M7e3t7MQKPV0Zv1gNm+awB0MvlshqLxfLb29uyJElWURSbXC4XXyvqxcXFs6mpqeTc3Nzu3t7e3wQcA7BPZ8Cov1pNlJplmQtAG8MwHV6v95tAINA5MDBwPxAIuLu6upr8fr/VAN3c3JQjkcjZ+vp6fnl5+d2bN29SuVzuNYAEpf01CdRChUL+X1VskHACuA3Ay3Fcu9vt7nA6nZ7m5uYWQRCaNE3jVVW15PP580KhIGUymWw2m00DOAJwSP4WwPtq4LX2Ao6USxNlQyS/RcQcdLGwlNIz6vEMAaZpNzCk2Pll94LK/cDYimxERiBwG10sxjgvEZBE0UpE6vxj+0Ct5bTaXthgEhRmja8QWNkkPGsuIpfdjpkK+cZUWTC0KredVmtD/gdlSl6EG4AMvQAAAABJRU5ErkJggg=="},"2edd":function(t,e,i){"use strict";i("c803")},"398c":function(t,e,i){"use strict";i("071c")},"3a15":function(t,e,i){"use strict";i("034f")},4405:function(t,e,i){},"53bd":function(t,e,i){},"568b":function(t,e,i){t.exports=i.p+"img/dmriprep-icon.e1416b54.svg"},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("a026"),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},r=[],s=i("5f5b");i("f9e3"),i("2dd8");n["default"].use(s["b"]);var o={name:"App"},l=o,c=(i("034fb"),i("2877")),u=Object(c["a"])(l,a,r,!1,null,null,null),h=u.exports,d=i("8c4f"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",["getInput"===t.state?n("b-container",{staticClass:"px-0",attrs:{fluid:""}},[n("b-row",{staticClass:"d-flex align-items-center"},[n("b-col",{staticClass:"text-right",attrs:{cols:"5"}},[n("img",{staticClass:"logo",attrs:{src:i("568b")}})]),n("b-col",{staticClass:"text-left",attrs:{cols:"7"}},[n("h1",[t._v("dmriprep Viewer")])])],1),n("b-form-group",{staticClass:"mt-5 text-left",attrs:{label:"Choose a directory containing dwiqc.json files generated with dmriprep or qsiprep:",description:"All computation happens on the client side. Your report will not be uploaded to any server."}},[n("b-form-file",{attrs:{directory:"",multiple:"",placeholder:"Choose a directory..."},model:{value:t.files,callback:function(e){t.files=e},expression:"files"}})],1),n("b-form-group",{staticClass:"mt-5 text-left",attrs:{label:"OR copy/paste an Amazon S3 URI:",description:"Enter a valid Amazon S3 URI of the form s3://bucket/followed/by/a/key."}},[n("b-input-group",{staticClass:"mb-3",attrs:{size:"md",prepend:"URL"}},[n("b-form-input",{attrs:{placeholder:"s3://dmriprep-viewer-example-data"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.navigate(e)}},model:{value:t.url,callback:function(e){t.url=e},expression:"url"}}),n("b-input-group-append",[n("b-btn",{attrs:{size:"md",text:"Button",variant:"primary"},on:{click:t.navigate}},[t._v("Go")])],1)],1)],1)],1):t._e(),"showLoader"===t.state?n("spinner"):t._e(),"showReports"===t.state?n("genReport",{attrs:{filesProp:t.reportFiles,groupFileProp:t.groupReportFiles}}):t._e()],1)},m=[],b=(i("2ca0"),i("5319"),i("ac1f"),i("4de4"),i("8a79"),i("b0c0"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-container",{staticClass:"px-0 m-3",attrs:{fluid:""}},[t.groupReport?i("b-container",{staticClass:"px-0",attrs:{fluid:""}},[i("b-sidebar",{attrs:{id:"sidebar-backdrop",title:"Study overview","backdrop-variant":"dark",backdrop:"",lazy:"",shadow:"",visible:t.showInitialSidebar}},[i("explainer",{attrs:{"explainer-text":"Select a subject below to see their report. Or select the study ID at the top to see a group summary. You can filter the subject list using the text input. You can close this sidebar by clicking on the 'x' in the top right or by simply clicking outside of the sidebar."}}),i("b-nav",{staticClass:"w-100",attrs:{vertical:"",pills:""}},[i("b-nav-item",{staticClass:"mx-1",attrs:{active:t.showStudyQc},on:{click:function(e){t.showStudyQc=!0}}},[t._v(" "+t._s(t.groupReport.studyId?t.groupReport.studyId:"Study")+" ")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.subjectFilter,expression:"subjectFilter"}],staticClass:"m-1",attrs:{placeholder:"filter subjects"},domProps:{value:t.subjectFilter},on:{input:function(e){e.target.composing||(t.subjectFilter=e.target.value)}}}),t._l(t.filteredSubjects,(function(e){return i("b-nav-item",{key:e,staticClass:"mx-1",attrs:{active:e===t.subjectSelected},on:{click:function(i){t.subjectSelected=e}}},[t.subjectRatings[e].reviewed?i("b-icon",{staticClass:"mr-2",attrs:{"align-self":"end",icon:"check-circle-fill",scale:"0.9",variant:"success"}}):i("b-icon",{staticClass:"mr-2",attrs:{icon:"circle",scale:"0.5",variant:"secondary"}}),t._v(" "+t._s(e)+" ")],1)}))],2)],1),t.showStudyQc&&t.groupReport?i("groupReport",{attrs:{reportProp:t.groupReport},on:{subjectSelected:t.updateSelectedSubject,ratingsDownloadRequested:t.downloadRatings,ratingsUploaded:t.uploadRatings,nextSubjectRequested:t.nextSubjectRequested}}):t.subjectSelected&&t.reportReady?i("report",{attrs:{reportProp:t.selectedSubjectReport,ratingProp:t.subjectRatings[t.subjectSelected]},on:{ratingsDownloadRequested:t.downloadRatings,ratingsUploaded:t.uploadRatings,nextSubjectRequested:t.nextSubjectRequested}}):i("spinner")],1):i("spinner")],1)}),f=[],g=i("1da1"),v=i("2909"),x=(i("96cf"),i("a15b"),i("6062"),i("d3b7"),i("3ca3"),i("ddb0"),i("466d"),i("07ac"),i("d81d"),i("b64b"),i("159b"),i("2b3d"),i("1276"),i("a434"),i("99af"),i("13d5"),i("caad"),i("2532"),i("bc3a")),w=i.n(x),y=i("2ef0"),S=i.n(y),j=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.collapseId&&t.questionId?i("b-container",{staticClass:"text-right"},[i("b-icon",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:t.collapseId,expression:"collapseId"}],staticClass:"question-mark when-open",attrs:{id:t.closeId,icon:"x-circle",variant:"primary","aria-hidden":"true"}}),i("b-icon",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:t.collapseId,expression:"collapseId"}],staticClass:"question-mark when-closed",attrs:{id:t.questionId,icon:"question-circle",variant:"primary","aria-hidden":"true"}}),i("b-collapse",{staticClass:"mb-2 text-left",attrs:{id:t.collapseId}},[i("b-card",[i("p",{staticClass:"card-text"},[t._v(t._s(t.explainerText))])])],1),i("b-tooltip",{attrs:{target:t.questionId,triggers:"hover"}},[t._v("learn more about this component")]),i("b-tooltip",{attrs:{target:t.closeId,triggers:"hover"}},[t._v("close the explainer")])],1):t._e()},C=[],R={name:"explainer",data:function(){return{collapseId:null,questionId:null,closeId:null}},props:{explainerText:{type:String,default:"Here is a helpful description of this component!"}},mounted:function(){this.collapseId="collapse"+this._uid,this.questionId="question"+this._uid,this.closeId="close"+this._uid}},_=R,k=(i("6244"),Object(c["a"])(_,j,C,!1,null,"19620c5a",null)),P=k.exports,A=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-container",{staticClass:"px-0",attrs:{fluid:""}},[t.groupReport?i("b-container",{staticClass:"px-0",attrs:{fluid:""}},[i("topBar",{attrs:{reportProp:t.groupReport,sidebarOn:"",isGroupReport:""},on:{ratingsDownloadRequested:t.ratingsDownloadRequested,ratingsUploaded:t.ratingsUploaded,nextSubjectRequested:t.nextSubjectRequested}}),i("explainer",{attrs:{"explainer-text":t.explainerText.qcMetrics}}),i("b-form-group",{staticClass:"text-left",attrs:{label:"Select scatterplot metrics"}},[i("b-form-checkbox-group",{attrs:{id:"checkbox-group-scatter",options:t.metricOptions,name:"scatter-metrics"},model:{value:t.scatterMetrics,callback:function(e){t.scatterMetrics=e},expression:"scatterMetrics"}})],1),i("scatterplotMatrix",{attrs:{dataProp:t.groupReport["subjects"],metricsProp:t.scatterMetrics},on:{updateBrushedSubjects:t.updateBrushedSubjects,updateSelectedSubject:t.updateSelectedSubject}}),i("b-form-group",{staticClass:"text-left",attrs:{label:"Select violin plot metrics"}},[i("b-form-checkbox-group",{attrs:{id:"checkbox-group-violin",options:t.metricOptions,name:"violin-metrics"},model:{value:t.violinMetrics,callback:function(e){t.violinMetrics=e},expression:"violinMetrics"}})],1),t._l(t.violinMetrics,(function(e){return i("violinPlot",{key:e,attrs:{data:t.groupReport["subjects"],metric:e},on:{updateBrushedSubjects:t.updateBrushedSubjects,updateSelectedSubject:t.updateSelectedSubject}})})),i("b-card",{staticClass:"text-left p-0 mb-5 mt-2",attrs:{footer:"This list scrolls left/right. Click on a participant ID to go to their report."},scopedSlots:t._u([{key:"header",fn:function(){return[i("b-row",{staticClass:"d-flex align-items-center"},[i("b-col",{staticClass:"text-left",attrs:{cols:"7"}},[i("h5",{staticClass:"m-0"},[t._v(" Selected subjects: "+t._s(t.brushedSubjectsIntersection.length)+" ")])]),i("b-col",{staticClass:"text-right",attrs:{cols:"5"}},[i("b-button",{staticClass:"m-0",attrs:{id:"clipboard-button",variant:"outline-primary"},on:{click:function(e){return t.copyBrushedSubjectsToClipboard()}}},[i("b-icon",{staticClass:"p m-0",attrs:{icon:"clipboard","aria-hidden":"true"}})],1),i("b-tooltip",{attrs:{target:"clipboard-button",triggers:"hover"}},[t._v("copy subject list to clipboard")])],1)],1)]},proxy:!0}],null,!1,1731478097)},[i("b-card-text",[i("b-nav",{staticClass:"pb-0 text-left brushed-subject-nav",attrs:{vertical:""}},t._l(t.brushedSubjectsIntersection,(function(e){return i("b-nav-item",{key:e,on:{click:function(i){return t.updateSelectedSubject(e)}}},[t._v(t._s(e))])})),1)],1)],1)],2):i("spinner")],1)},M=[],F=i("ade3"),I=i("5530"),O=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"scatterdiv"}},[i("svg",{ref:"chart",staticClass:"scatterplot-matrix",attrs:{id:"scattersvg"}})])},X=[],Y=i("3835"),Z=i("5698"),z={name:"ScatterplotMatrix",props:{dataProp:{type:Array},metricsProp:{type:Array}},data:function(){return{margin:{top:10,right:10,bottom:10,left:20},maxWidth:650,width:null,padding:20,radius:4,brushedSubjects:null,metrics:[],data:[],mounted:!1}},computed:{height:function(){return this.metrics.length?this.width:0},size:function(){return(this.width-(this.columns.length+1)*this.padding)/this.columns.length+this.padding},columns:function(){var t=this;return Object.keys(this.data[0]).filter((function(e){return t.metrics.includes(e)&&"number"===typeof t.data[0][e]}))},yAxis:function(){var t=this,e=Z.axisLeft().ticks(6).tickSize(-this.size*this.columns.length),i=this;return function(n){return n.selectAll("g").data(t.y).join("g").attr("transform",(function(t,e){return"translate(0,".concat(e*i.size,")")})).each((function(t){return Z.select(this).call(e.scale(t))})).call((function(t){return t.select(".domain").remove()})).call((function(t){return t.selectAll(".tick line").attr("stroke","#ddd")}))}},xAxis:function(){var t=this,e=Z.axisBottom().ticks(6).tickSize(this.size*this.columns.length),i=this;return function(n){return n.selectAll("g").data(t.x).join("g").attr("transform",(function(t,e){return"translate(".concat(e*i.size,",0)")})).each((function(t){return Z.select(this).call(e.scale(t))})).call((function(t){return t.select(".domain").remove()})).call((function(t){return t.selectAll(".tick line").attr("stroke","#ddd")}))}},x:function(){var t=this,e=this.padding+this.margin.left+this.margin.right;return this.columns.map((function(i){return Z.scaleLinear().domain(Z.extent(t.data,(function(t){return t[i]}))).rangeRound([e/2,t.size-e/2])}))},y:function(){var t=this.padding+this.margin.top+this.margin.top,e=this;return this.x.map((function(i){return i.copy().range([e.size-t/2,t/2])}))}},watch:{brushedSubjects:{deep:!0,handler:function(){this.$emit("updateBrushedSubjects",{metric:"scatterplotMatrix",brushed:this.brushedSubjects})}},metricsProp:{deep:!0,immediate:!0,handler:function(){this.metricsProp&&(this.metrics=this.metricsProp,this.mounted&&this.createChart())}},dataProp:{deep:!0,immediate:!0,handler:function(){this.dataProp&&(this.data=this.dataProp)}}},mounted:function(){this.width=Math.min(this.$refs.chart.clientWidth,this.maxWidth),this.brushedSubjects=this.data.map((function(t){return t.subject_session_id})),this.createChart(),this.mounted=!0},methods:{createChart:function(){Z.selection.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))},Z.selection.prototype.moveToBack=function(){return this.each((function(){var t=this.parentNode.firstChild;t&&this.parentNode.insertBefore(this,t)}))},Z.select("#scatterdiv").append("div").attr("id","scattertooltip").attr("style","position: absolute; background-color: white; display: none; padding: 2px; border: 1px solid black; border-radius: 5px;"),Z.selectAll("#scattersvg > *").remove();var t=Z.select("#scattersvg").attr("width",this.width).attr("height",this.height).append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")");t.append("style").text("circle.hidden { fill: #000; fill-opacity: 1; r: ".concat(this.radius/3,"; }")),t.append("g").call(this.xAxis),t.append("g").call(this.yAxis);var e=this,i=t.append("g").selectAll("g").data(Z.cross(Z.range(this.columns.length),Z.range(this.columns.length))).join("g").attr("transform",(function(t){var i=Object(Y["a"])(t,2),n=i[0],a=i[1];return"translate(".concat(n*e.size,",").concat(a*e.size,")")}));i.append("rect").attr("fill","none").attr("stroke","#aaa").attr("x",this.padding/2+.5).attr("y",this.padding/2+.5).attr("width",this.size-this.padding).attr("height",this.size-this.padding),i.each((function(t){var i=Object(Y["a"])(t,2),n=i[0],a=i[1];Z.select(this).selectAll("circle").data(e.data.filter((function(t){return!isNaN(t[e.columns[n]])&&!isNaN(t[e.columns[a]])}))).join("circle").attr("cx",(function(t){return e.x[n](t[e.columns[n]])})).attr("cy",(function(t){return e.y[a](t[e.columns[a]])}))})),i.call(this.brush);var n=i.selectAll("circle").attr("r",this.radius).attr("fill-opacity",.7).attr("fill","blue").style("cursor","pointer").on("mouseover",(function(t){Z.select(Z.event.currentTarget).transition().duration(100).attr("r",2*e.radius),Z.select("#scattertooltip").transition().duration(200).style("display","initial").text(t.subject_session_id)})).on("mouseout",(function(){Z.select(Z.event.currentTarget).transition().duration(100).attr("r",e.radius),Z.select("#scattertooltip").style("display","none")})).on("mousemove",(function(){Z.select("#scattertooltip").style("left",Z.event.pageX+10+"px").style("top",Z.event.pageY+10+"px")})).on("click",(function(t){e.$emit("updateSelectedSubject",t.subject_session_id)}));return n.moveToFront(),t.append("g").style("font","bold 10px sans-serif").style("pointer-events","none").selectAll("text").data(this.columns).join("text").attr("transform",(function(t,i){return"translate(".concat(i*e.size,",").concat(i*e.size,")")})).attr("x",this.padding).attr("y",this.padding).attr("dy",".71em").attr("font-size","1.5em").text((function(t){return t})),t.node()},brush:function(t){var e,i=t.selectAll("circle"),n=this,a=Z.brush().extent([[this.padding/2,this.padding/2],[this.size-this.padding/2,this.size-this.padding/2]]).on("start",r).on("brush",s).on("end",o);function r(){e!==this&&(Z.select(e).call(a.move,null),e=this)}function s(t){var e=Object(Y["a"])(t,2),a=e[0],r=e[1];if(null!==Z.event.selection){var s=Object(Y["a"])(Z.event.selection,2),o=Object(Y["a"])(s[0],2),l=o[0],c=o[1],u=Object(Y["a"])(s[1],2),h=u[0],d=u[1];i.classed("hidden",(function(t){return l>n.x[a](t[n.columns[a]])||h<n.x[a](t[n.columns[a]])||c>n.y[r](t[n.columns[r]])||d<n.y[r](t[n.columns[r]])})),n.brushedSubjects=n.data.filter((function(t){return n.x[a](t[n.columns[a]])>=l&&n.x[a](t[n.columns[a]])<=h&&n.y[r](t[n.columns[r]])>=c&&n.y[r](t[n.columns[r]])<=d})).map((function(t){return t.subject_session_id}))}}function o(){null===Z.event.selection&&(i.classed("hidden",!1),n.brushedSubjects=n.data.map((function(t){return t.subject_session_id})))}t.call(a)},handleResize:function(){var t=this;this.width=Math.min(this.$refs.chart.clientWidth,this.$refs.chart.clientHeight);var e=Z.select("#scattersvg").attr("width",this.width-this.margin.left-this.margin.right);this.x.forEach((function(e){return e.range([0,t.width-t.margin.left-t.margin.right])}));var i=this;e.selectAll("rect").attr("x",(function(t){return i.x(t.i)})).attr("width",this.x.bandwidth())}}},q=z,E=(i("eeb0"),Object(c["a"])(q,O,X,!1,null,"5d8babb8",null)),B=E.exports,T=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-container",[i("strong",[t._v("Loading...")]),i("b-spinner",{staticClass:"ml-4",attrs:{variant:"primary",label:"loading"}})],1)},N=[],D={name:"spinner"},U=D,W=Object(c["a"])(U,T,N,!1,null,"92fa8f0e",null),V=W.exports,$=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-button-toolbar",{staticClass:"sticky-top ml-2"},[i("b-button-group",[i("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.sidebar-backdrop",modifiers:{"sidebar-backdrop":!0}}],staticClass:"mb-2 header-button",attrs:{id:"sidebar-button",variant:"outline-primary"}},[i("b-icon",{attrs:{icon:"layout-sidebar","aria-hidden":"true"}})],1),i("b-button",{staticClass:"mb-2 header-button",attrs:{id:"download-button",variant:"outline-primary"},on:{click:t.download}},[i("b-icon",{attrs:{icon:"download","aria-hidden":"true"}})],1),t.isGroupReport?t._e():i("b-button",{staticClass:"mb-2 header-button",attrs:{id:"stats-button",variant:"outline-primary"}},[i("b-icon",{attrs:{icon:"bar-chart","aria-hidden":"true"}})],1),t.isGroupReport?t._e():i("b-popover",{attrs:{target:"stats-button",placement:"bottom",triggers:"click"},scopedSlots:t._u([{key:"title",fn:function(){return[t._v(t._s(t.subjectId))]},proxy:!0}],null,!1,3138654337)},[t._v(" Here are distributions of some key QC metrics ")]),t.isGroupReport?t._e():i("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.rating-modal",modifiers:{"rating-modal":!0}}],staticClass:"mb-2 header-button",attrs:{id:"rating-button",variant:"outline-primary"}},[i("b-iconstack",[i("b-icon",{attrs:{stacked:"",icon:"check-circle",scale:"0.75","shift-v":"6","shift-h":"-6","aria-hidden":"true"}}),i("b-icon",{attrs:{stacked:"",icon:"slash",scale:"1.5","aria-hidden":"true"}}),i("b-icon",{attrs:{stacked:"",icon:"x-circle",scale:"0.75","shift-v":"-6","shift-h":"6","aria-hidden":"true"}})],1)],1),t.isGroupReport?t._e():i("b-modal",{ref:"rating-modal",attrs:{id:"rating-modal",title:t.subjectId},on:{ok:t.onOk,hidden:t.handleHidden}},[i("div",{staticClass:"mb-2"},[t._v(" Rate this subject: ")]),t.rating?i("b-form",{ref:"form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[i("b-form-group",{attrs:{id:"input-group-overall","label-for":"overall-rating",description:"Rate the overall image quality.","invalid-feedback":"rating required",state:t.state(t.rating.rating)}},[i("b-form-radio-group",{attrs:{id:"overall-rating",options:t.ratingOptions,"button-variant":"outline-primary",size:"md",buttons:""},model:{value:t.rating.rating,callback:function(e){t.$set(t.rating,"rating",e)},expression:"rating.rating"}})],1)],1):t._e()],1),i("b-button",{staticClass:"mb-2 header-button",attrs:{id:"next-subject-button",variant:"outline-primary"},on:{click:t.nextSubject}},[i("b-icon",{attrs:{icon:"arrow-right-circle","aria-hidden":"true"}})],1),i("b-dropdown",{staticClass:"mb-2 header-button",attrs:{variant:"outline-primary"},scopedSlots:t._u([{key:"button-content",fn:function(){return[i("b-icon",{attrs:{icon:"three-dots",id:"more-button","aria-hidden":"true"}})]},proxy:!0}])},[i("b-dropdown-item-button",{attrs:{id:"download-csv",variant:"outline-primary"},on:{click:function(e){return t.ratingsDownloadRequested()}}},[i("b-iconstack",{staticClass:"mr-3",attrs:{"aria-hidden":"true"}},[i("b-icon",{attrs:{stacked:"",icon:"download","shift-h":"-10",variant:"outline-primary"}}),i("b-icon",{attrs:{stacked:"",icon:"list-check","shift-h":"7",variant:"outline-primary"}})],1),t._v(" download ratings csv ")],1),i("b-dropdown-item-button",{directives:[{name:"b-modal",rawName:"v-b-modal.csv-upload-modal",modifiers:{"csv-upload-modal":!0}}],attrs:{id:"upload-csv",variant:"outline-primary"}},[i("b-iconstack",{staticClass:"mr-3",attrs:{"aria-hidden":"true"}},[i("b-icon",{attrs:{stacked:"",icon:"upload","shift-h":"-10",variant:"outline-primary"}}),i("b-icon",{attrs:{stacked:"",icon:"list-check","shift-h":"7",variant:"outline-primary"}})],1),t._v(" upload ratings csv ")],1),i("b-dropdown-item-button",{attrs:{id:"file-issue",variant:"outline-primary",onclick:"window.open('https://github.com/nipreps/dmriprep-viewer/issues/new','_blank')"}},[i("b-icon",{staticClass:"mr-3",attrs:{icon:"bug","aria-hidden":"true"}}),t._v(" file bug report ")],1)],1)],1),i("b-modal",{ref:"csv-upload-modal",attrs:{id:"csv-upload-modal",title:"Upload a ratings csv file"},on:{ok:t.onCsvUploadOk}},[i("b-form-group",{staticClass:"mt-5 text-left",attrs:{label:"Choose a previously downloaded ratings.csv file."}},[i("b-form-file",{attrs:{state:Boolean(t.ratingsCsvFile),placeholder:"Choose a file or drop it here...","drop-placeholder":"Drop file here..."},model:{value:t.ratingsCsvFile,callback:function(e){t.ratingsCsvFile=e},expression:"ratingsCsvFile"}})],1)],1),i("b-tooltip",{attrs:{target:"sidebar-button",triggers:"hover"}},[t._v("toggle sidebar")]),i("b-tooltip",{attrs:{target:"download-button",triggers:"hover"}},[t._v("download this report.json file")]),t.isGroupReport?t._e():i("b-tooltip",{attrs:{target:"stats-button",triggers:"hover"}},[t._v("show QC summary stats")]),t.isGroupReport?t._e():i("b-tooltip",{attrs:{target:"rating-button",triggers:"hover"}},[t._v("rate this subject")]),i("b-tooltip",{attrs:{target:"next-subject-button",triggers:"hover"}},[t._v("view the next subject")]),i("b-tooltip",{attrs:{target:"more-button",triggers:"hover"}},[t._v("more options")])],1)},H=[],L=(i("25f0"),i("b1e0")),Q=i("f751"),G=i("21a6");n["default"].use(s["a"]),n["default"].use(L["a"]),n["default"].use(Q["a"]);var J={name:"topBar",props:{reportProp:{type:Object},ratingProp:{type:Object,default:null},sidebarOn:{type:Boolean,default:!1},isGroupReport:{type:Boolean,default:!1}},data:function(){return{report:null,rating:null,subjectId:"loading...",ratingsCsvFile:null,ratingOptions:[{text:"Definitely Fail",value:"-2"},{text:"Probably Fail",value:"-1"},{text:"Not Sure",value:"0"},{text:"Probably Pass",value:"1"},{text:"Definitely Pass",value:"2"}]}},methods:{state:function(t){return null!=t},checkFormValidity:function(){var t=null!=this.rating.rating;return t},onOk:function(t){t.preventDefault(),this.handleSubmit()},handleHidden:function(){this.checkFormValidity()||(this.rating.reviewed=!1,this.rating.whenRated=null)},handleSubmit:function(){var t=this;this.checkFormValidity()&&(this.rating.whenRated=(new Date).toString(),this.rating.reviewed=!0,this.$nextTick((function(){t.$bvModal.hide("rating-modal")})))},download:function(){var t=new Blob([JSON.stringify(this.report)],{type:"application/json",name:"report.json"});G["saveAs"](t,"report.json")},nextSubject:function(){this.$emit("nextSubjectRequested")},ratingsDownloadRequested:function(){this.$emit("ratingsDownloadRequested")},onCsvUploadOk:function(){var t=this;this.ratingsCsvFile&&this.$papa.parse(this.ratingsCsvFile,{header:!0,dynamicTyping:!0,skipEmptyLines:!0,complete:function(e){t.$emit("ratingsUploaded",e.data.reduce((function(t,e){return t[e.subject]=Object.assign({reviewed:!0},e),t}),{}))}})}},mounted:function(){this.reportProp&&(this.report=this.reportProp,this.subjectId=this.reportProp["subject_id"]),this.ratingProp&&(this.rating=this.ratingProp)},watch:{reportProp:function(){this.reportProp&&(this.report=this.reportProp,this.subjectId=this.reportProp["subject_id"])},ratingProp:function(){this.ratingProp&&(this.rating=this.ratingProp)}}},K=J,tt=(i("00e5"),Object(c["a"])(K,$,H,!1,null,"5317fe18",null)),et=tt.exports,it=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:t.divId}},[i("h6",{staticClass:"m-0 p-0 text-left"},[t._v(t._s(t.metric))]),i("svg",{ref:"chart",staticClass:"violin-plot",attrs:{id:t.svgId}})])},nt=[],at=i("b85c"),rt=i("5698"),st={name:"violinPlot",props:{data:{type:Array},metric:{type:String}},data:function(){return{margin:{top:10,right:10,bottom:20,left:10},width:null,height:250,radius:5,brushedSubjects:null,hoveredSubject:null,brushObject:null,histogram:null,bins:null,maxNum:null,yNum:null}},computed:{boxHeight:function(){return this.height/6},center:function(){return this.height/2-this.margin.bottom},padding:function(){return.1*this.radius},svgId:function(){return"violinsvg-"+this.metric},divId:function(){return"violindiv-"+this.metric},tooltipId:function(){return"tooltip-"+this.metric},x:function(){var t=this;return rt.scaleLinear().domain(rt.extent(this.data,(function(e){return e[t.metric]}))).range([this.margin.left,this.width-this.margin.right])},dodgedData:function(){return this.dodge(this.data,2*this.radius+this.padding)},boxPlotInfo:function(){var t=this,e=this.data.map((function(e){return e[t.metric]})).sort(rt.ascending),i=rt.quantile(e,.25),n=rt.quantile(e,.5),a=rt.quantile(e,.75),r=a-i;return{q1:i,median:n,q3:a,interQuantileRange:r,min:i-1.5*r,max:i+1.5*r}}},watch:{brushedSubjects:{deep:!0,handler:function(){this.$emit("updateBrushedSubjects",{metric:this.metric,brushed:this.brushedSubjects})}}},mounted:function(){this.width=this.$refs.chart.clientWidth,this.brushedSubjects=this.data.map((function(t){return t.subject_session_id}));var t=this.getHighestPoint();while(t<this.margin.top)this.radius=this.radius-.1,this.radius<3&&(this.radius=5,this.height=this.height+50),t=this.getHighestPoint();this.createChart()},methods:{getHighestPoint:function(){return this.height-this.boxHeight-this.margin.bottom-this.margin.top-this.radius-this.padding-Math.max.apply(Math,Object(v["a"])(this.dodgedData.map((function(t){return t.y}))))},dodge:function(t,e){var i=this,n=Math.pow(e,2),a=t.map((function(t){return{x:i.x(t[i.metric]),data:t}})).sort((function(t,e){return t.x-e.x})),r=.001,s=null,o=null;function l(t,e){var i=s;while(i){if(n-r>Math.pow(i.x-t,2)+Math.pow(i.y-e,2))return!0;i=i.next}return!1}var c,u=Object(at["a"])(a);try{for(u.s();!(c=u.n()).done;){var h=c.value;while(s&&s.x<h.x-n)s=s.next;if(l(h.x,h.y=0)){var d=s;h.y=1/0;do{var p=d.y+Math.sqrt(n-Math.pow(d.x-h.x,2));p<h.y&&!l(h.x,p)&&(h.y=p),d=d.next}while(d)}h.next=null,null===s?s=o=h:o=o.next=h}}catch(m){u.e(m)}finally{u.f()}return a},createChart:function(){var t=this;rt.select("#"+this.divId).append("div").attr("id",this.tooltipId).attr("style","position: absolute; background-color: white; display: none; padding: 2px; border: 1px solid black; border-radius: 5px;");var e=rt.select("#"+this.svgId).attr("viewBox",[0,0,this.width,this.height]);e.append("style").text("circle.hidden { fill: #000; fill-opacity: 1; r: ".concat(this.radius/2,"; }"));var i=this,n=this.x,a=function(t){return t.attr("transform","translate(0,".concat(i.height-i.margin.bottom,")")).call(rt.axisBottom(n).tickSizeOuter(0))};e.append("g").call(a);var r=rt.brushX().extent([[this.margin.left,this.margin.top],[this.width-this.margin.right,this.height-this.margin.bottom]]).on("brush",s).on("end",o);function s(){if(null!==rt.event.selection){var t=rt.selectAll("#"+i.svgId+" circle"),e=Object(Y["a"])(rt.event.selection,2),n=e[0],a=e[1];t.classed("hidden",(function(t){return n>t.x||a<t.x})),i.brushedSubjects=i.data.filter((function(t){return i.x(t[i.metric])>=n&&i.x(t[i.metric])<=a})).map((function(t){return t.subject_session_id}))}}function o(){if(null===rt.event.selection){var t=rt.selectAll("#"+i.svgId+" circle");t.classed("hidden",!1),i.brushedSubjects=i.data.map((function(t){return t.subject_session_id}))}}e.call(r);var l=rt.scaleSequential().interpolator(rt.interpolateCool).domain(n.domain());e.append("g").selectAll("circle").data(this.dodgedData).join("circle").attr("cx",(function(t){return t.x})).attr("cy",(function(t){return i.height-i.boxHeight-i.margin.bottom-i.margin.top-i.radius-i.padding-t.y})).attr("r",this.radius).style("fill",(function(t){return l(t.data[i.metric])})).style("cursor","pointer").attr("stroke","white").on("mouseover",(function(e){i.hoveredSubject=e.data.subject_session_id,rt.select(rt.event.currentTarget).transition().duration(100).attr("r",1.5*i.radius),rt.select("#"+t.tooltipId).transition().duration(200).style("display","initial").text(e.data.subject_session_id)})).on("mouseout",(function(){i.hoveredSubject=null,rt.select(rt.event.currentTarget).transition().duration(100).attr("r",i.radius),rt.select("#"+t.tooltipId).style("display","none")})).on("mousemove",(function(){rt.select("#"+t.tooltipId).style("left",rt.event.pageX+10+"px").style("top",rt.event.pageY+10+"px")})).on("click",(function(t){i.$emit("updateSelectedSubject",t.data.subject_session_id)})),e.append("line").attr("x1",n(this.boxPlotInfo.min)).attr("x2",n(this.boxPlotInfo.max)).attr("y1",this.height-this.margin.bottom-this.padding-this.radius-this.boxHeight/2).attr("y2",this.height-this.margin.bottom-this.padding-this.radius-this.boxHeight/2).attr("stroke","black").attr("stroke-width",2),e.append("rect").attr("y",this.height-this.margin.bottom-this.boxHeight-this.padding-this.radius).attr("x",n(this.boxPlotInfo.q1)).attr("width",n(this.boxPlotInfo.q3)-n(this.boxPlotInfo.q1)).attr("height",this.boxHeight).attr("stroke","none").style("fill","grey"),e.selectAll("toto").data([this.boxPlotInfo.min,this.boxPlotInfo.median,this.boxPlotInfo.max]).enter().append("line").attr("y1",this.height-this.margin.bottom-this.boxHeight-this.padding-this.radius).attr("y2",this.height-this.margin.bottom-this.padding-this.radius).attr("x1",(function(t){return n(t)})).attr("x2",(function(t){return n(t)})).attr("stroke","black").attr("stroke-width",2)}}},ot=st,lt=(i("2edd"),Object(c["a"])(ot,it,nt,!1,null,"6b3b5c74",null)),ct=lt.exports,ut={name:"groupReport",components:{explainer:P,scatterplotMatrix:B,spinner:V,topBar:et,violinPlot:ct},data:function(){return{groupReport:null,brushedSubjects:{},brushedSubjectsIntersection:[],scatterMetrics:[],violinMetrics:[],explainerText:{qcMetrics:"Quality Control (QC) metrics are computed before and after the preprocessing pipeline is run on dMRI data. In the sections below, any QC measure computed on the unprocessed dMRI data will begin with 'raw_' while the same measure calculated on the preprocessed images will begin with 't1_' (assuming this the output space of the data is T1w). Basic properties of the scans such as the number of directions and dimensions of the images are available as well. Select measures below to see how they are distributed relative to on another."}}},props:{reportProp:{type:Object}},mounted:function(){var t=this;this.reportProp&&(this.groupReport=this.reportProp),this.scatterMetrics=[],this.violinMetrics=[],this.brushedSubjects=this.metricOptions.reduce((function(e,i){return Object(I["a"])(Object(I["a"])({},e),{},Object(F["a"])({},i,t.groupReport.subjects.map((function(t){return t.subject_session_id}))))}),{}),this.brushedSubjects.scatterplotMatrix=this.groupReport.subjects.map((function(t){return t.subject_session_id}))},methods:{updateBrushedSubjects:function(t){this.brushedSubjects[t.metric]=t.brushed,this.brushedSubjectsIntersection=Object.values(this.brushedSubjects).reduce((function(t,e){return t.filter((function(t){return e.includes(t)}))}),this.groupReport.subjects.map((function(t){return t.subject_session_id})))},nextSubjectRequested:function(){this.$emit("nextSubjectRequested")},updateSelectedSubject:function(t){this.$emit("subjectSelected",t)},ratingsDownloadRequested:function(){this.$emit("ratingsDownloadRequested")},ratingsUploaded:function(t){this.$emit("ratingsUploaded",t)},copyBrushedSubjectsToClipboard:function(){navigator.clipboard.writeText(this.brushedSubjectsIntersection.join())}},computed:{metricOptions:function(){return Object.keys(this.groupReport.subjects[0]).filter((function(t){return!["participant_id","subject_id","subject_session_id","session_id","file_name"].includes(t)})).sort()}},watch:{reportProp:function(){this.reportProp&&(this.groupReport=this.reportProp)}}},ht=ut,dt=(i("398c"),Object(c["a"])(ht,A,M,!1,null,"264d0fe0",null)),pt=dt.exports,mt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-container",{staticClass:"px-0",attrs:{fluid:""}},[t.report?i("b-container",{staticClass:"px-0",attrs:{fluid:""}},[i("topBar",{attrs:{reportProp:t.report,ratingProp:t.rating},on:{ratingsDownloadRequested:t.ratingsDownloadRequested,ratingsUploaded:t.ratingsUploaded,nextSubjectRequested:t.nextSubjectRequested}}),i("b-row",[i("b-col",[i("h1",[t._v(t._s(t.report.subject_id))]),i("h2",{staticClass:"mt-3 pt-3"},[t._v("Corrected dwi")]),i("p",{staticClass:"lead"},[t._v("Motion and distortion corrected file")]),i("div",{staticStyle:{"background-color":"black"}},[i("explainer",{attrs:{"explainer-text":t.explainerText.dwiTimeSeriesSprite}}),t._l(t.report.dwi_corrected,(function(e){return i("sprite4d",{key:e.orientation,attrs:{M:e.M,N:e.N,img:e.img,num_slices:e.num_slices,pix:e.pix,id:e.orientation,time:t.time,overlayMode:!1,opacity:"1"}})}))],2),i("vue-slider",{ref:"timeSlider",attrs:{min:0,max:t.report.dwi_corrected[0].num_slices-1},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}}),i("explainer",{attrs:{"explainer-text":t.explainerText.lineChart}}),i("div",{staticStyle:{height:"200px",width:"100%",display:"inline-flex"}},[i("line-chart",{attrs:{id:"motion_params",data:t.report.eddy_params,outlier_indices:t.report.outlier_volumes,xlabel:"TR",ylabel:"RMS",highlightIdx:t.time}})],1),i("explainer",{attrs:{"explainer-text":t.explainerText.carpetPlot}}),i("CarpetPlot",{attrs:{data:t.report.carpetplot,highlightIdx:t.time}}),i("vue-slider",{ref:"timeSlider",attrs:{min:0,max:t.report.dwi_corrected[0].num_slices-1},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}}),i("explainer",{attrs:{"explainer-text":t.explainerText.qSpace}}),i("QSpaceGroup",{attrs:{report:t.report,time:t.time}}),i("h2",{staticClass:"mt-3 pt-3"},[t._v("Registration + Brain Mask")]),i("p",{staticClass:"lead"},[t._v("Brain mask computed on T1w, and mapped to B0")]),i("explainer",{attrs:{"explainer-text":t.explainerText.brainMaskSprite}}),i("BrainSprite",{ref:"brainMaskSprite",attrs:{id:"brainMaskSprite",base_dim_x:t.report.b0.pix,base_dim_y:t.report.b0.pix,overlay_dim_x:t.report.anat_mask.pix,overlay_dim_y:t.report.anat_mask.pix,base:t.report.b0.img,overlay:t.report.anat_mask.img}}),i("h2",{staticClass:"mt-3 pt-3"},[t._v("DTI: ColorFA")]),i("p",{staticClass:"lead"},[t._v("Color FA mapped on B0")]),i("explainer",{attrs:{"explainer-text":t.explainerText.colorFASprite}}),i("BrainSprite",{ref:"colorFASprite",attrs:{id:"colorFASprite",base_dim_x:t.report.b0.pix,base_dim_y:t.report.b0.pix,overlay_dim_x:t.report.colorFA.pix,overlay_dim_y:t.report.colorFA.pix,base:t.report.b0.img,overlay:t.report.colorFA.img}})],1)],1)],1):i("spinner")],1)},bt=[],ft=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"brainsprite"},[t.done?t._e():i("div",[t._v("Hold on...")]),i("canvas",{attrs:{id:t.id}}),t.showOrig?i("img",{staticClass:"hidden",attrs:{id:t.id+"_spriteImg",src:"data:image/png;base64,"+t.base}}):t._e(),t.overlay&&t.showOrig?i("img",{staticClass:"hidden",attrs:{id:t.id+"_overlayImg",src:"data:image/png;base64,"+t.overlay}}):t._e()])},gt=[];i("c35a"),i("a9e3");function vt(t){function e(t,e){return t.imageSmoothingEnabled=e,t}var i={},n={nanValue:!1,smooth:!1,flagValue:!1,colorBackground:"#000000",flagCoordinates:!1,origin:{X:0,Y:0,Z:0},voxelSize:1,affine:!1,heightColorBar:.04,sizeFont:.075,colorFont:"#FFFFFF",nbDecimals:3,crosshair:!1,colorCrosshair:"#0000FF",sizeCrosshair:.9,title:!1,numSlice:!1};i=Object.assign({},n,t);return"boolean"===typeof i.affine&&!1===i.affine&&(i.affine=[[i.voxelSize,0,0,-i.origin.X],[0,i.voxelSize,0,-i.origin.Y],[0,0,i.voxelSize,-i.origin.Z],[0,0,0,1]]),i.canvas=document.getElementById(t.canvas),i.context=i.canvas.getContext("2d"),i.context=e(i.context,i.smooth),i.canvasY=document.createElement("canvas"),i.contextY=i.canvasY.getContext("2d"),i.canvasZ=document.createElement("canvas"),i.contextZ=i.canvasZ.getContext("2d"),i.canvasRead=document.createElement("canvas"),i.contextRead=i.canvasRead.getContext("2d"),i.canvasRead.width=1,i.canvasRead.height=1,i.onclick="undefined"!==typeof t.onclick?t.onclick:"",i.flagCoordinates?i.spaceFont=.1:i.spaceFont=0,i.sprite=document.getElementById(t.sprite),i.nbCol=i.sprite.width/t.nbSlice.Y,i.nbRow=i.sprite.height/t.nbSlice.Z,i.nbSlice={X:"undefined"!==typeof t.nbSlice.X?t.nbSlice.X:i.nbCol*i.nbRow,Y:t.nbSlice.Y,Z:t.nbSlice.Z},i.widthCanvas={X:0,Y:0,Z:0},i.heightCanvas={X:0,Y:0,Z:0,max:0},0==i.numSlice&&(i.numSlice={X:Math.floor(i.nbSlice.X/2),Y:Math.floor(i.nbSlice.Y/2),Z:Math.floor(i.nbSlice.Z/2)}),i.coordinatesSlice={X:0,Y:0,Z:0},i.planes={},i.planes.canvasMaster=document.createElement("canvas"),i.planes.contextMaster=i.planes.canvasMaster.getContext("2d"),t.overlay="undefined"!==typeof t.overlay&&t.overlay,t.overlay&&(i.overlay={},i.overlay.sprite=document.getElementById(t.overlay.sprite),i.overlay.nbCol=i.overlay.sprite.width/t.overlay.nbSlice.Y,i.overlay.nbRow=i.overlay.sprite.height/t.overlay.nbSlice.Z,i.overlay.nbSlice={X:"undefined"!==typeof t.overlay.nbSlice.X?t.overlay.nbSlice.X:i.overlay.nbCol*i.overlay.nbRow,Y:t.overlay.nbSlice.Y,Z:t.overlay.nbSlice.Z},i.overlay.opacity="undefined"!==typeof t.overlay.opacity?t.overlay.opacity:1),t.colorMap="undefined"!==typeof t.colorMap&&t.colorMap,t.colorMap&&(i.colorMap={},i.colorMap.img=document.getElementById(t.colorMap.img),i.colorMap.min=t.colorMap.min,i.colorMap.max=t.colorMap.max,t.colorMap.hide="undefined"!==typeof t.colorMap.hide&&t.colorMap.hide,i.colorMap.canvas=document.createElement("canvas"),i.colorMap.context=i.colorMap.canvas.getContext("2d"),i.colorMap.canvas.width=i.colorMap.img.width,i.colorMap.canvas.height=i.colorMap.img.height,i.colorMap.context.drawImage(i.colorMap.img,0,0,i.colorMap.img.width,i.colorMap.img.height,0,0,i.colorMap.img.width,i.colorMap.img.height)),i.getValue=function(t,e){if(!e)return NaN;var i,n,a,r,s,o;a=e.canvas.width,r=NaN,s=1/0;for(var l=0;l<a;l++)i=e.context.getImageData(l,0,1,1).data,n=Math.pow(i[0]-t[0],2)+Math.pow(i[1]-t[1],2)+Math.pow(i[2]-t[2],2),n<s&&(r=l,s=n);return o=r*(e.max-e.min)/(a-1)+e.min,o},i.updateValue=function(){var t={},e=[],n=[];if(i.overlay&&!i.nanValue)try{t.XW=Math.round(i.numSlice.X%i.nbCol),t.XH=Math.round((i.numSlice.X-t.XW)/i.nbCol),i.contextRead.fillStyle="#FFFFFF",i.contextRead.fillRect(0,0,1,1),i.contextRead.drawImage(i.overlay.sprite,t.XW*i.nbSlice.Y+i.numSlice.Y,t.XH*i.nbSlice.Z+i.nbSlice.Z-i.numSlice.Z-1,1,1,0,0,1,1);var a=i.contextRead.getImageData(0,0,1,1).data;e=255==a[0]&&255==a[1]&&255==a[2],i.contextRead.fillStyle="#000000",i.contextRead.fillRect(0,0,1,1),i.contextRead.drawImage(i.overlay.sprite,t.XW*i.nbSlice.Y+i.numSlice.Y,t.XH*i.nbSlice.Z+i.nbSlice.Z-i.numSlice.Z-1,1,1,0,0,1,1),a=i.contextRead.getImageData(0,0,1,1).data,n=0==a[0]&&0==a[1]&&0==a[2],i.voxelValue=e&&n?NaN:i.getValue(a,i.colorMap)}catch(r){console.warn(r.message),rgb=0,i.nanValue=!0,i.voxelValue=NaN}else i.voxelValue=NaN},i.multiply=function(t,e){for(var i=t.length,n=t[0].length,a=(e.length,e[0].length),r=new Array(i),s=0;s<i;++s){r[s]=new Array(a);for(var o=0;o<a;++o){r[s][o]=0;for(var l=0;l<n;++l)r[s][o]+=t[s][l]*e[l][o]}}return r},i.updateCoordinates=function(){var t=i.multiply(i.affine,[[i.numSlice.X+1],[i.numSlice.Y+1],[i.numSlice.Z+1],[1]]);i.coordinatesSlice.X=t[0],i.coordinatesSlice.Y=t[1],i.coordinatesSlice.Z=t[2]},i.init=function(){i.widthCanvas.X=Math.floor(i.canvas.parentElement.clientWidth*(i.nbSlice.Y/(2*i.nbSlice.X+i.nbSlice.Y))),i.widthCanvas.Y=Math.floor(i.canvas.parentElement.clientWidth*(i.nbSlice.X/(2*i.nbSlice.X+i.nbSlice.Y))),i.widthCanvas.Z=Math.floor(i.canvas.parentElement.clientWidth*(i.nbSlice.X/(2*i.nbSlice.X+i.nbSlice.Y))),i.widthCanvas.max=Math.max(i.widthCanvas.X,i.widthCanvas.Y,i.widthCanvas.Z),i.heightCanvas.X=Math.floor(i.widthCanvas.X*i.nbSlice.Z/i.nbSlice.Y),i.heightCanvas.Y=Math.floor(i.widthCanvas.Y*i.nbSlice.Z/i.nbSlice.X),i.heightCanvas.Z=Math.floor(i.widthCanvas.Z*i.nbSlice.Y/i.nbSlice.X),i.heightCanvas.max=Math.max(i.heightCanvas.X,i.heightCanvas.Y,i.heightCanvas.Z),i.canvas.width!=i.widthCanvas.X+i.widthCanvas.Y+i.widthCanvas.Z&&(i.canvas.width=i.widthCanvas.X+i.widthCanvas.Y+i.widthCanvas.Z,i.canvas.height=Math.round((1+i.spaceFont)*i.heightCanvas.max),i.context=e(i.context,i.smooth)),i.sizeFontPixels=Math.round(i.sizeFont*i.heightCanvas.max),i.context.font=i.sizeFontPixels+"px Arial",i.planes.canvasMaster.width=i.sprite.width,i.planes.canvasMaster.height=i.sprite.height,i.planes.contextMaster.globalAlpha=1,i.planes.contextMaster.drawImage(i.sprite,0,0,i.sprite.width,i.sprite.height,0,0,i.sprite.width,i.sprite.height),i.overlay&&(i.planes.contextMaster.globalAlpha=i.overlay.opacity,i.planes.contextMaster.drawImage(i.overlay.sprite,0,0,i.overlay.sprite.width,i.overlay.sprite.height,0,0,i.sprite.width,i.sprite.height)),i.planes.canvasX=document.createElement("canvas"),i.planes.contextX=i.planes.canvasX.getContext("2d"),i.planes.canvasX.width=i.nbSlice.Y,i.planes.canvasX.height=i.nbSlice.Z,i.planes.canvasY=document.createElement("canvas"),i.planes.contextY=i.planes.canvasY.getContext("2d"),i.planes.canvasY.width=i.nbSlice.X,i.planes.canvasY.height=i.nbSlice.Z,i.planes.canvasZ=document.createElement("canvas"),i.planes.contextZ=i.planes.canvasZ.getContext("2d"),i.planes.canvasZ.width=i.nbSlice.X,i.planes.canvasZ.height=i.nbSlice.Y,i.planes.contextZ.rotate(-Math.PI/2),i.planes.contextZ.translate(-i.nbSlice.Y,0),i.updateValue(),i.updateCoordinates(),i.numSlice.X=Math.round(i.numSlice.X),i.numSlice.Y=Math.round(i.numSlice.Y),i.numSlice.Z=Math.round(i.numSlice.Z)},i.draw=function(t,e){var n,a,r={},s={X:"",Y:"",Z:""};switch(s.X=Math.ceil((1-i.sizeCrosshair)*i.nbSlice.X/2),s.Y=Math.ceil((1-i.sizeCrosshair)*i.nbSlice.Y/2),s.Z=Math.ceil((1-i.sizeCrosshair)*i.nbSlice.Z/2),e){case"X":r.XW=i.numSlice.X%i.nbCol,r.XH=(i.numSlice.X-r.XW)/i.nbCol,i.planes.contextX.drawImage(i.planes.canvasMaster,r.XW*i.nbSlice.Y,r.XH*i.nbSlice.Z,i.nbSlice.Y,i.nbSlice.Z,0,0,i.nbSlice.Y,i.nbSlice.Z),i.crosshair&&(i.planes.contextX.fillStyle=i.colorCrosshair,i.planes.contextX.fillRect(i.numSlice.Y,s.Z,1,i.nbSlice.Z-2*s.Z),i.planes.contextX.fillRect(s.Y,i.nbSlice.Z-i.numSlice.Z-1,i.nbSlice.Y-2*s.Y,1)),i.context.fillStyle=i.colorBackground,i.context.fillRect(0,0,i.widthCanvas.X,i.canvas.height),i.context.drawImage(i.planes.canvasX,0,0,i.nbSlice.Y,i.nbSlice.Z,0,(i.heightCanvas.max-i.heightCanvas.X)/2,i.widthCanvas.X,i.heightCanvas.X),i.title&&(i.context.fillStyle=i.colorFont,i.context.fillText(i.title,Math.round(i.widthCanvas.X/10),Math.round(i.heightCanvas.max*i.heightColorBar+1/4*i.sizeFontPixels))),i.flagValue&&(value="value = "+Number.parseFloat(i.voxelValue).toPrecision(i.nbDecimals).replace(/0+$/,""),valueWidth=i.context.measureText(value).width,i.context.fillStyle=i.colorFont,i.context.fillText(value,Math.round(i.widthCanvas.X/10),Math.round(i.heightCanvas.max*i.heightColorBar*2+3/4*i.sizeFontPixels))),i.flagCoordinates&&(n="x = "+Math.round(i.coordinatesSlice.X),a=i.context.measureText(n).width,i.context.fillStyle=i.colorFont,i.context.fillText(n,i.widthCanvas.X/2-a/2,Math.round(i.canvas.height-i.sizeFontPixels/2)));break;case"Y":i.context.fillStyle=i.colorBackground,i.context.fillRect(i.widthCanvas.X,0,i.widthCanvas.Y,i.canvas.height);for(var o=0;o<i.nbSlice.X;o++){var l=o%i.nbCol,c=(o-l)/i.nbCol;i.planes.contextY.drawImage(i.planes.canvasMaster,l*i.nbSlice.Y+i.numSlice.Y,c*i.nbSlice.Z,1,i.nbSlice.Z,o,0,1,i.nbSlice.Z)}i.crosshair&&(i.planes.contextY.fillStyle=i.colorCrosshair,i.planes.contextY.fillRect(i.numSlice.X,s.Z,1,i.nbSlice.Z-2*s.Z),i.planes.contextY.fillRect(s.X,i.nbSlice.Z-i.numSlice.Z-1,i.nbSlice.X-2*s.X,1)),i.context.drawImage(i.planes.canvasY,0,0,i.nbSlice.X,i.nbSlice.Z,i.widthCanvas.X,(i.heightCanvas.max-i.heightCanvas.Y)/2,i.widthCanvas.Y,i.heightCanvas.Y),i.colorMap&&!i.colorMap.hide&&(i.context.drawImage(i.colorMap.img,0,0,i.colorMap.img.width,1,Math.round(i.widthCanvas.X+.2*i.widthCanvas.Y),Math.round(i.heightCanvas.max*i.heightColorBar/2),Math.round(.6*i.widthCanvas.Y),Math.round(i.heightCanvas.max*i.heightColorBar)),i.context.fillStyle=i.colorFont,label_min=Number.parseFloat(i.colorMap.min).toPrecision(i.nbDecimals).replace(/0+$/,""),label_max=Number.parseFloat(i.colorMap.max).toPrecision(i.nbDecimals).replace(/0+$/,""),i.context.fillText(label_min,i.widthCanvas.X+.2*i.widthCanvas.Y-i.context.measureText(label_min).width/2,Math.round(i.heightCanvas.max*i.heightColorBar*2+3/4*i.sizeFontPixels)),i.context.fillText(label_max,i.widthCanvas.X+.8*i.widthCanvas.Y-i.context.measureText(label_max).width/2,Math.round(i.heightCanvas.max*i.heightColorBar*2+3/4*i.sizeFontPixels))),i.flagCoordinates&&(i.context.font=i.sizeFontPixels+"px Arial",i.context.fillStyle=i.colorFont,n="y = "+Math.round(i.coordinatesSlice.Y),a=i.context.measureText(n).width,i.context.fillText(n,i.widthCanvas.X+i.widthCanvas.Y/2-a/2,Math.round(i.canvas.height-i.sizeFontPixels/2)));case"Z":i.context.fillStyle=i.colorBackground,i.context.fillRect(i.widthCanvas.X+i.widthCanvas.Y,0,i.widthCanvas.Z,i.canvas.height);for(var u=0;u<i.nbSlice.X;u++){var h=u%i.nbCol,d=(u-h)/i.nbCol;i.planes.contextZ.drawImage(i.planes.canvasMaster,h*i.nbSlice.Y,d*i.nbSlice.Z+i.nbSlice.Z-i.numSlice.Z-1,i.nbSlice.Y,1,0,u,i.nbSlice.Y,1)}i.crosshair&&(i.planes.contextZ.fillStyle=i.colorCrosshair,i.planes.contextZ.fillRect(s.Y,i.numSlice.X,i.nbSlice.Y-2*s.Y,1),i.planes.contextZ.fillRect(i.numSlice.Y,s.X,1,i.nbSlice.X-2*s.X)),i.context.drawImage(i.planes.canvasZ,0,0,i.nbSlice.X,i.nbSlice.Y,i.widthCanvas.X+i.widthCanvas.Y,(i.heightCanvas.max-i.heightCanvas.Z)/2,i.widthCanvas.Z,i.heightCanvas.Z),i.flagCoordinates&&(n="z = "+Math.round(i.coordinatesSlice.Z),a=i.context.measureText(n).width,i.context.fillStyle=i.colorFont,i.context.fillText(n,i.widthCanvas.X+i.widthCanvas.Y+i.widthCanvas.Z/2-a/2,Math.round(i.canvas.height-i.sizeFontPixels/2)))}},i.clickBrain=function(t){var e,n,a,r=i.canvas.getBoundingClientRect(),s=t.clientX-r.left,o=t.clientY-r.top;s<i.widthCanvas.X?(n=Math.round((i.nbSlice.Y-1)*(s/i.widthCanvas.X)),a=Math.round((i.nbSlice.Z-1)*((i.heightCanvas.max+i.heightCanvas.X)/2-o)/i.heightCanvas.X),i.numSlice.Y=Math.max(Math.min(n,i.nbSlice.Y-1),0),i.numSlice.Z=Math.max(Math.min(a,i.nbSlice.Z-1),0)):s<i.widthCanvas.X+i.widthCanvas.Y?(s-=i.widthCanvas.X,e=Math.round((i.nbSlice.X-1)*(s/i.widthCanvas.Y)),a=Math.round((i.nbSlice.Z-1)*((i.heightCanvas.max+i.heightCanvas.X)/2-o)/i.heightCanvas.X),i.numSlice.X=Math.max(Math.min(e,i.nbSlice.X-1),0),i.numSlice.Z=Math.max(Math.min(a,i.nbSlice.Z-1),0)):(s=s-i.widthCanvas.X-i.widthCanvas.Y,e=Math.round((i.nbSlice.X-1)*(s/i.widthCanvas.Z)),n=Math.round((i.nbSlice.Y-1)*((i.heightCanvas.max+i.heightCanvas.Z)/2-o)/i.heightCanvas.Z),i.numSlice.X=Math.max(Math.min(e,i.nbSlice.X-1),0),i.numSlice.Y=Math.max(Math.min(n,i.nbSlice.Y-1),0)),i.updateValue(),i.updateCoordinates(),i.drawAll(),i.onclick&&i.onclick(t)},i.drawAll=function(){i.draw(i.numSlice.X,"X"),i.draw(i.numSlice.Y,"Y"),i.draw(i.numSlice.Z,"Z")},i.canvas.addEventListener("click",i.clickBrain,!1),i.canvas.addEventListener("mousedown",(function(t){i.canvas.addEventListener("mousemove",i.clickBrain,!1)}),!1),i.canvas.addEventListener("mouseup",(function(t){i.canvas.removeEventListener("mousemove",i.clickBrain,!1)}),!1),i.sprite.addEventListener("load",(function(){i.init(),i.drawAll()})),i.overlay&&i.overlay.sprite.addEventListener("load",(function(){i.init(),i.drawAll()})),i.init(),i.drawAll(),i}var xt=vt,wt={name:"brainsprite",props:["base","overlay","id","base_dim_x","base_dim_y","overlay_dim_x","overlay_dim_y"],data:function(){return{brain:null,showOrig:!0,done:!1}},methods:{refreshBrainSprite:function(){var t=new xt({canvas:this.id,sprite:"".concat(this.id,"_spriteImg"),nbSlice:{Y:this.base_dim_x,Z:this.base_dim_y},overlay:{sprite:"".concat(this.id,"_overlayImg"),nbSlice:{Y:this.overlay_dim_x,Z:this.overlay_dim_y},opacity:.5}});this.brain=t,this.showOrig=!1,this.done=!0}},watch:{$props:{handler:function(){var t=this;this.showOrig=!0,this.done=!1,this.$nextTick((function(){setTimeout((function(){t.refreshBrainSprite()}),100)}))}}},mounted:function(){var t=this;this.$nextTick((function(){setTimeout((function(){t.refreshBrainSprite()}),100)}))}},yt=wt,St=(i("9b07"),Object(c["a"])(yt,ft,gt,!1,null,"3f09f206",null)),jt=St.exports,Ct=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("resize-observer",{on:{notify:t.handleResize}}),i("svg",{ref:"chart",staticClass:"carpetplot",attrs:{id:"carpetsvg",width:t.width,height:t.height}},[i("g",{attrs:{transform:"translate("+t.margin.left+","+t.margin.top+")"}},t._l(t.dataFlattened,(function(e){return i("rect",{key:e.i+":"+e.j,attrs:{x:t.x(e.i),y:t.y(e.j),rx:"4",ry:"4",width:t.x.bandwidth(),height:t.y.bandwidth(),fill:t.myColor(e.value),"stroke-width":"4",stroke:"none",opacity:e.i===t.highlightIdx?1:.5}})})),0)])],1)},Rt=[],_t=i("5698"),kt={name:"Carpetplot",props:{data:{type:Array},highlightIdx:{type:Number}},data:function(){return{margin:{top:10,right:25,bottom:10,left:40},mounted:!1,width:null,height:500}},computed:{innerWidth:function(){return this.width-this.margin.left-this.margin.right},innerHeight:function(){return 450-this.margin.top-this.margin.bottom},dataFlattened:function(){for(var t=this.data.length,e=this.data[0].length,i=[],n=0;n<t;n+=1)for(var a=0;a<e;a+=1)i.push({i:n,j:a,value:this.data[n][a]});return i},x:function(){var t=_t.map(this.dataFlattened,(function(t){return t.i})).keys();return _t.scaleBand().range([0,this.innerWidth]).domain(t).padding(.05)},y:function(){var t=_t.map(this.dataFlattened,(function(t){return t.j})).keys();return _t.scaleBand().range([this.innerHeight,0]).domain(t).padding(.05)},myColor:function(){return _t.scaleSequential().interpolator(_t.interpolateInferno).domain([0,1])}},mounted:function(){this.mounted=!0,this.width=this.$refs.chart.clientWidth},methods:{handleResize:function(){this.width=this.$refs.chart.clientWidth}}},Pt=kt,At=(i("b8a2"),Object(c["a"])(Pt,Ct,Rt,!1,null,null,null)),Mt=At.exports,Ft=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"qspace-parent"}},[i("p",{staticClass:"lead"},[t._v("q-space Sampling")]),i("b-row",[i("b-col",[i("b-checkbox",{model:{value:t.autoRotate,callback:function(e){t.autoRotate=e},expression:"autoRotate"}},[t._v(" auto rotate ")])],1),i("b-col",[i("b-checkbox",{model:{value:t.showReflection,callback:function(e){t.showReflection=e},expression:"showReflection"}},[t._v(" show reflected points ")])],1)],1),i("b-row",[i("b-col",[i("QSpaceViewer",{attrs:{elementId:"qSpaceViewerPre",qcoords:t.report.q_coords,colors:t.report.color,cameraPosition:t.globalPosition,autoRotate:t.autoRotate,showReflectedPoints:t.showReflection,highlightIdx:t.time},on:{updateCameraPosition:t.updateGlobalPosition}}),i("p",{staticClass:"lead"},[t._v("Original")])],1),i("b-col",[i("QSpaceViewer",{attrs:{elementId:"qSpaceViewerPost",qcoords:t.report.q_coords,colors:t.report.color,cameraPosition:t.globalPosition,autoRotate:t.autoRotate,showReflectedPoints:t.showReflection,highlightIdx:t.time},on:{updateCameraPosition:t.updateGlobalPosition}}),i("p",{staticClass:"lead"},[t._v("Corrected")])],1)],1)],1)},It=[],Ot=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:t.elementId}})},Xt=[],Yt=(i("cfc3"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),i("ace4"),i("4fad"),i("5a89")),Zt=i("4721"),zt=i("ef20"),qt=i("183b"),Et={name:"qSpaceViewer",props:{qcoords:{type:Array},colors:{type:Array},elementId:{type:String},cameraPosition:{type:Object},autoRotate:{type:Boolean},showReflectedPoints:{type:Boolean},highlightIdx:{type:Number}},data:function(){return{scene:null,camera:null,controls:null,renderer:null,ambient:null,particles:null,reflectedParticles:null,showStats:!1,stats:null,container:null,unhighlightedSize:null,unhighlightedAlpha:.4}},mounted:function(){this.init(),this.animate()},watch:{highlightIdx:function(){this.highlightPoint()},autoRotate:function(){this.toggleAutoRotate()},showReflectedPoints:function(){this.toggleReflectedPoints()}},methods:{init:function(){this.container=document.getElementById(this.elementId);for(var t,e=this.qcoords,i=this.colors,n=[],a=[],r=new Yt["e"],s=0,o=e.length,l=0,c=o;l<c;l++){t=e[l],n.push(t[0],t[1],t[2]);var u=Math.max(Math.abs(t[0],t[1],t[2]));u>s&&(s=u),r.setRGB(i[l][0],i[l][1],i[l][2]),a.push(r.r,r.g,r.b)}this.unselectedSize=.15*s;for(var h=new Float32Array(o),d=new Float32Array(o),p=0,m=o;p<m;p++)h[p]=p===this.highlightIdx?3*this.unselectedSize:this.unselectedSize,d[p]=p===this.highlightIdx?1:.25;var b=new Yt["c"];b.setAttribute("position",new Yt["g"](n,3)),b.setAttribute("customColor",new Yt["g"](a,3)),b.setAttribute("size",new Yt["b"](h,1)),b.setAttribute("alpha",new Yt["b"](d,1)),this.scene=new Yt["o"],this.camera=new Yt["l"](75,1,.001,10*s),this.camera.position.z=2*s,this.camera.position.y=1*s,this.ambient=new Yt["a"](1118481),this.scene.add(this.ambient);var f="\n        attribute float alpha;\n        attribute float size;\n        attribute vec3 customColor;\n        varying vec3 vColor;\n        varying float vAlpha;\n\n        void main() {\n          vColor = customColor;\n          vAlpha = alpha;\n          vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n          gl_PointSize = size * ( 300.0 / -mvPosition.z );\n          gl_Position = projectionMatrix * mvPosition;\n        }\n        ",g="\n        uniform vec3 color;\n        uniform sampler2D pointTexture;\n        varying vec3 vColor;\n        varying float vAlpha;\n\n        void main() {\n          gl_FragColor = vec4( color * vColor, vAlpha );\n          gl_FragColor = gl_FragColor * texture2D( pointTexture, gl_PointCoord );\n        }\n        ",x=(new Yt["s"]).load(qt),w=new Yt["p"]({uniforms:{color:{value:new Yt["e"](16777215)},pointTexture:{value:x}},vertexShader:f,fragmentShader:g,transparent:!0,depthWrite:!1});this.particles=new Yt["m"](b,w),this.scene.add(this.particles);for(var y=[],S=0,j=o;S<j;S++)t=e[S],y.push(-t[0],-t[1],-t[2]);var C=new Yt["c"];C.setAttribute("position",new Yt["g"](y,3)),C.setAttribute("customColor",new Yt["g"](a,3)),C.setAttribute("size",new Yt["b"](h,1)),C.setAttribute("alpha",new Yt["b"](d,1)),this.reflectedParticles=new Yt["m"](C,w),this.scene.add(this.reflectedParticles),this.reflectedParticles.visible=this.showReflectedPoints;var R=new Yt["h"],_={x:[[0,0,0],[1.25*s,0,0]],y:[[0,0,0],[0,1.25*s,0]],z:[[0,0,0],[0,0,1.25*s]]},k=Object.assign.apply(Object,Object(v["a"])(Object.entries(_).map((function(t){var e=Object(Y["a"])(t,2),i=e[0],n=e[1];return Object(F["a"])({},i,n.map((function(t){return new Yt["v"](t[0],t[1],t[2])})))})))),P=Object.assign.apply(Object,Object(v["a"])(Object.entries(k).map((function(t){var e=Object(Y["a"])(t,2),i=e[0],n=e[1];return Object(F["a"])({},i,new Yt["d"](n))})))),A=Object.assign.apply(Object,Object(v["a"])(Object.entries(P).map((function(t){var e=Object(Y["a"])(t,2),i=e[0],n=e[1];return Object(F["a"])({},i,new Yt["t"](n,50,.01*s,8,!0))})))),M={x:new Yt["k"]({color:"red",depthWrite:!0}),y:new Yt["k"]({color:"green",depthWrite:!0}),z:new Yt["k"]({color:"blue",depthWrite:!0})},I=new Yt["j"](A.x,M.x),O=new Yt["j"](A.y,M.y),X=new Yt["j"](A.z,M.z);R.add(I),R.add(O),R.add(X),this.scene.add(R),this.renderer=new Yt["w"]({alpha:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.container.clientWidth,this.container.clientWidth),this.container.appendChild(this.renderer.domElement),this.controls=new Zt["a"](this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.25,this.controls.enableZoom=!0,this.controls.autoRotate=this.autoRotate,this.controls.maxDistance=5*s,this.controls.enableKeys=!1,this.controls.addEventListener("change",this.emitCameraEvent),this.showStats&&(this.stats=new zt["a"],this.stats.domElement.style.position="relative",this.stats.domElement.style.top="0px",this.stats.domElement.style.right="0px",this.container.appendChild(this.stats.domElement)),this.container.addEventListener("resize",this.onWindowResize,!1)},animate:function(){requestAnimationFrame(this.animate),this.render(),this.showStats&&this.stats.update()},highlightPoint:function(){for(var t=this.particles.geometry.attributes.alpha,e=this.particles.geometry.attributes.size,i=0;i<t.count;i++)t.array[i]=i===this.highlightIdx?1:.25,e.array[i]=i===this.highlightIdx?3*this.unselectedSize:this.unselectedSize;t.needsUpdate=!0,e.needsUpdate=!0;for(var n=this.reflectedParticles.geometry.attributes.alpha,a=this.reflectedParticles.geometry.attributes.size,r=0;r<n.count;r++)n.array[r]=r===this.highlightIdx?1:.25,a.array[r]=r===this.highlightIdx?3*this.unselectedSize:this.unselectedSize;n.needsUpdate=!0,a.needsUpdate=!0},toggleAutoRotate:function(){this.controls.autoRotate=this.autoRotate},toggleReflectedPoints:function(){this.reflectedParticles.visible=this.showReflectedPoints},render:function(){this.renderer.render(this.scene,this.camera),this.cameraPosition&&this.camera.position.copy(this.cameraPosition),this.controls.update()},onWindowResize:function(){this.renderer.setSize(this.container.clientWidth,this.container.clientWidth)},emitCameraEvent:function(){this.$emit("updateCameraPosition",this.camera.position)}}},Bt=Et,Tt=Object(c["a"])(Bt,Ot,Xt,!1,null,null,null),Nt=Tt.exports,Dt={name:"QSpaceGroup",components:{QSpaceViewer:Nt},props:{report:{type:Object},time:{type:Number}},data:function(){return{autoRotate:!1,showReflection:!1,globalPosition:null}},methods:{updateGlobalPosition:function(t){this.globalPosition=t}}},Ut=Dt,Wt=Object(c["a"])(Ut,Ft,It,!1,null,null,null),Vt=Wt.exports,$t=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{height:"200px",width:"100%",display:"inline-flex"}},[i("resize-observer",{on:{notify:t.handleResize}}),i("svg",{ref:"chart",staticClass:"lineChart",attrs:{id:t.id,width:t.width,height:t.height}})],1)},Ht=[],Lt=i("5698");window.d3=Lt;var Qt={name:"lineChart",data:function(){return{svg:null,g:null,x:null,y:null,xDomain:[0,1],yDomain:[0,1],margin:{top:20,right:20,bottom:30,left:50},lines:[],width:null,height:null}},computed:{},watch:{highlightIdx:function(){this.updateHighlightPoints()}},methods:{initAx:function(){this.width=this.$refs.chart.clientWidth-this.margin.left-this.margin.right,this.height=this.$refs.chart.clientHeight-this.margin.top-this.margin.bottom;var t=Lt.select("#".concat(this.id)),e=t.append("g").attr("transform","translate(".concat(this.margin.left,", ").concat(this.margin.top,")")),i=Lt.scaleLinear().range([this.height,0]),n=Lt.scaleLinear().range([0,this.width]);this.svg=t,this.g=e,this.x=n,this.y=i,this.initXaxis(),this.initYaxis(),this.initHighlightPoints()},initXaxis:function(){this.g.append("g").attr("class","x axis").attr("transform","translate(0, ".concat(this.height,")")).call(Lt.axisBottom(this.x))},updateXaxis:function(){this.x.range([0,this.width]).domain(this.xDomain),Lt.select("#".concat(this.id," .x.axis")).call(Lt.axisBottom(this.x))},initYaxis:function(){this.g.append("g").attr("class","y axis").call(Lt.axisLeft(this.y)).append("text").attr("fill","#000").attr("transform","rotate(-90)").attr("y",6).attr("dy","0.71em").attr("text-anchor","end").text(this.ylabel)},updateYaxis:function(){this.y.range([this.height,0]).domain(this.yDomain),Lt.select("#".concat(this.id," .y.axis")).call(Lt.axisLeft(this.y))},initHighlightPoints:function(){this.g.append("circle").attr("class","dot-series-1"),this.g.append("circle").attr("class","dot-series-2")},updateHighlightPoints:function(){var t=this;Lt.select("#".concat(this.id," .dot-series-1")).attr("r",7).attr("cx",(function(){return t.x(t.highlightIdx)})).attr("cy",(function(){return t.y(t.data[t.highlightIdx][0])})).attr("fill","steelblue"),Lt.select("#".concat(this.id," .dot-series-2")).attr("r",7).attr("cx",(function(){return t.x(t.highlightIdx)})).attr("cy",(function(){return t.y(t.data[t.highlightIdx][1])})).attr("fill","red")},plotData:function(){var t=this,e=Lt.min(this.data,(function(t,e){return e})),i=Lt.max(this.data,(function(t,e){return e})),n=Lt.max(this.data,(function(t,e){return Lt.max(t)})),a=Lt.min(this.data,(function(t,e){return Lt.min(t)}));this.xDomain=[e,i],this.yDomain=[a,n],this.updateXaxis(),this.updateYaxis();var r=Lt.line().x((function(e,i){return t.x(i)})).y((function(e,i){return t.y(e[0])})),s=Lt.line().x((function(e,i){return t.x(i)})).y((function(e,i){return t.y(e[1])}));this.lines=[r,s],this.g.append("path").attr("class","series-1").datum(this.data).attr("fill","none").attr("stroke","steelblue").attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("stroke-width",1.5).attr("d",r),this.g.append("path").attr("class","series-2").datum(this.data).attr("fill","none").attr("stroke","red").attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("stroke-width",1.5).attr("d",s),this.g.selectAll(".outlier").data(this.outlier_indices).enter().append("rect").attr("class","outlier").attr("x",(function(e){return t.x(e)-1.5})).attr("y",(function(){return t.y(n)})).attr("width","3px").attr("height",(function(){return"".concat(t.height,"px")})).attr("fill","black"),this.svg.on("mousemove",(function(){}))},handleResize:function(){this.width=this.$refs.chart.clientWidth-this.margin.left-this.margin.right,this.updateXaxis(),this.updateHighlightPoints();var t=this;this.g.selectAll(".outlier").attr("x",(function(e){return t.x(e)-1.5})).attr("height",(function(){return"".concat(t.height,"px")})),this.g.selectAll(".series-1").attr("d",this.lines[0]),this.g.selectAll(".series-2").attr("d",this.lines[1])}},mounted:function(){this.initAx(),this.plotData()},props:["ylabel","xlabel","data","id","highlightIdx","outlier_indices"]},Gt=Qt,Jt=(i("f968"),Object(c["a"])(Gt,$t,Ht,!1,null,null,null)),Kt=Jt.exports,te=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"mt-3"},[i("div",{staticClass:"sprite",style:t.style,attrs:{id:t.id}})])},ee=[],ie={name:"sprite4d",computed:{row_idx:function(){return Math.floor(this.time/this.M)},col_idx:function(){return this.time%this.M},style:function(){var t={width:"".concat(this.pix,"px"),height:"".concat(this.pix,"px"),zoom:1.5,"background-position-x":"-".concat(this.col_idx*this.pix,"px"),"background-position-y":"-".concat(this.row_idx*this.pix,"px"),"background-image":"url('data:image/png;base64,".concat(this.img,"')"),display:"inline-flex",opacity:this.opacity};return this.overlayMode&&(t.position="absolute",t.left="calc(50% - ".concat(this.pix/2,"px)")),t}},data:function(){return{}},methods:{},mounted:function(){},watch:{time:function(){}},props:["M","N","pix","num_slices","img","id","time","overlayMode","opacity"]},ne=ie,ae=(i("9784"),Object(c["a"])(ne,te,ee,!1,null,null,null)),re=ae.exports,se=i("252c"),oe=i("4971"),le=i.n(oe);i("3e39"),i("6eb0");n["default"].use(se["a"]),n["default"].use(s["a"]),n["default"].use(L["a"]);var ce={name:"report",components:{BrainSprite:jt,CarpetPlot:Mt,QSpaceGroup:Vt,explainer:P,lineChart:Kt,sprite4d:re,topBar:et,vueSlider:le.a},props:{reportProp:{type:Object,default:null},ratingProp:{type:Object,default:null}},data:function(){return{time:0,spriteSlice:0,globalPosition:null,autoRotate:!1,showReflection:!0,report:null,rating:null,explainerText:{dwiTimeSeriesSprite:"Axial, sagittal and coronal slices from each 3D image in the preprocessed dMRI series. ",lineChart:"Time series of Framewise Displacement (Blue) and RMS of head translation (Red)",carpetPlot:"The slice-by-image matrix of deviation from the predicted dMRI signal. Brighter colors indicate a more aberrant slice. Values can be negative or positive.",qSpace:"Shows the q-space coordinate of the image currently in the viewer. Expect different contrast as distance from the origin increases.",brainMaskSprite:"If a T1w image was included in preprocessing, its mask is shown as a red contour line. Otherwise a mask of the b=0 reference image is shown.",colorFASprite:"RGB values corresponding to principal direction of a tensor fit. Red is L-R, green is A-P and blue is I-S."}}},methods:{get_mid_slice:function(){return Math.floor(this.report.b0.num_slices/2)},updateGlobalPosition:function(t){this.globalPosition=t},ratingsDownloadRequested:function(){this.$emit("ratingsDownloadRequested")},ratingsUploaded:function(t){this.$emit("ratingsUploaded",t)},nextSubjectRequested:function(){this.$emit("nextSubjectRequested")}},mounted:function(){var t=this;this.reportProp&&(this.report=this.reportProp),this.ratingProp&&(this.rating=this.ratingProp),this.$nextTick((function(){t.report&&(t.spriteSlice=t.get_mid_slice())}))},watch:{reportProp:{immediate:!0,handler:function(t){t&&(this.report=t)},deep:!0},ratingProp:{immediate:!0,handler:function(){this.ratingProp&&(this.rating=this.ratingProp)},deep:!0},report:{immediate:!0,handler:function(){this.report&&(this.spriteSlice=this.get_mid_slice())},deep:!0}}},ue=ce,he=(i("3a15"),Object(c["a"])(ue,mt,bt,!1,null,"27067a64",null)),de=he.exports,pe={name:"genReport",components:{explainer:P,groupReport:pt,report:de,spinner:V},data:function(){return{bucket:null,files:null,groupFile:null,groupReport:null,manifestEntries:[],subRe:/sub-[a-z0-9]+/gi,sesRe:/ses-[a-z0-9]+/gi,reportReady:!1,s3Prefix:null,s3Uri:null,selectedSubjectReport:null,showInitialSidebar:!0,showStudyQc:!0,sourceType:null,subjectFilter:"",subjectReports:null,subjectRatings:null,subjectSelected:null,subjectsBrushed:[],url:null}},methods:{parseSubjectSession:function(t){return[Object(v["a"])(new Set(t.match(this.subRe)))[0],Object(v["a"])(new Set(t.match(this.sesRe)))[0]].join("_").replace(/_+$/,"")},uploadRatings:function(t){this.subjectRatings=Object.assign(this.subjectRatings,t)},downloadRatings:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var i,n,a,r,s,o,l,c,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=S.a.filter(Object.values(t.subjectRatings),(function(t){return t.reviewed})),n=i.map((function(t){return S.a.pick(t,["subject","rating","whenRated"])})),0!==n.length){e.next=4;break}return e.abrupt("return");case 4:a=",",r=Object.keys(n[0]).join(a)+"\n",s=r,n.forEach((function(t){s+=Object.values(t).join(a)+"\n"})),o=new Blob([s],{type:"text/csv"}),l=URL.createObjectURL(o),c=document.createElement("a"),c.href=l,c.target="_blank",u=(new Date).toISOString().replace(/[-:]/g,"").split(".")[0],c.download="dwiqc_ratings_"+u+".csv",c.click();case 16:case"end":return e.stop()}}),e)})))()},updateSelectedSubject:function(t){this.subjectSelected=t},nextSubjectRequested:function(){var t=this.subjectSelected?(this.filteredSubjects.indexOf(this.subjectSelected)+1)%this.filteredSubjects.length:0;this.subjectSelected=this.filteredSubjects[t]},loadFromQuery:function(){this.$route.query&&(this.$route.query.url||this.$route.query.s3Uri||"GenReport"!==this.$route.name?this.$route.query.url?(this.sourceType="url",this.url=this.$route.query.url,this.loadFromUrl()):this.$route.query.s3Uri&&(this.sourceType="s3",this.s3Uri=this.$route.query.s3Uri,this.bucket=this.s3Uri.split("/")[0],this.s3Prefix=this.s3Uri.split("/").splice(1).join("/"),this.loadFromS3()):this.$router.push("/"))},loadFromUrl:function(){var t=this;w.a.get(this.url).then((function(e){t.report=e.data}))},xmlParser:function(t){var e=new DOMParser,i=e.parseFromString(t,"text/xml");return i},parseS3:function(t){var e=this.xmlParser(t),i=e.getElementsByTagName("Key"),n=e.getElementsByTagName("NextContinuationToken"),a=e.getElementsByTagName("IsTruncated")[0].innerHTML;this.continuation="true"===a?encodeURIComponent(n[0].innerHTML):null;var r=S.a.map(i,(function(t){return t.innerHTML})),s=S.a.filter(r,(function(t){return t.endsWith("dwiqc.json")})),o=S.a.uniq(s);return o},S3Continuation:function(t){var e=this;if(!t)return 0;var i=this.s3ListUrl+"&continuation-token=".concat(t);return w.a.get(i).then((function(t){var i=e.parseS3(t.data);e.manifestEntries=S.a.uniq(e.manifestEntries.concat(i)),e.continuation&&e.S3Continuation(e.continuation)}))},loadFromS3:function(){var t=this,e=this,i=this.s3ListUrl;return w.a.get(i).then((function(e){var i=t.parseS3(e.data);t.manifestEntries=S.a.uniq(t.manifestEntries.concat(i)),t.continuation&&t.S3Continuation(t.continuation)})).then((function(){t.groupFile=t.manifestEntries.filter((function(t){return null===t.match(e.subRe)})),t.files=t.manifestEntries.filter((function(t){return null!==t.match(e.subRe)})),t.selectRootGroupFile(),t.loadGroupReport()}))},getFileDepth:function(t){return"file"===this.sourceType?t.webkitRelativePath.split("/").length:"s3"===this.sourceType?t.split("/").length:void 0},selectRootGroupFile:function(){if(1===this.groupFile.length)this.groupFile=this.groupFile[0];else{var t=S.a.groupBy(this.groupFile,this.getFileDepth),e=Math.min.apply(Math,Object(v["a"])(Object.keys(t))),i=t[e];1===i.length?this.groupFile=i[0]:this.groupFile=null}},readJsonFile:function(t){var e=new FileReader;return new Promise((function(i,n){e.onerror=function(){e.abort(),n(new DOMException("Problem parsing input file."))},e.onload=function(){i({file:t,content:JSON.parse(e.result)})},e.readAsText(t)}))},initSubjectReports:function(t){return Object(g["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.a.reduce(Object.keys(t),(function(e,i){return e[i]={source:t[i],report:null,whenRequested:null},e}),{});case 2:return i=e.sent,e.abrupt("return",i);case 4:case"end":return e.stop()}}),e)})))()},initSubjectRatings:function(t){return Object(g["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,S.a.reduce(Object.keys(t),(function(t,e){return t[e]={subject:e,rating:null,whenRated:null,reviewed:!1},t}),{});case 2:return i=e.sent,e.abrupt("return",i);case 4:case"end":return e.stop()}}),e)})))()},loadGroupReport:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("file"!==t.sourceType){e.next=7;break}return e.next=3,t.readJsonFile(t.groupFile);case 3:i=e.sent,t.groupReport=i["content"],e.next=12;break;case 7:if("s3"!==t.sourceType){e.next=12;break}return e.next=10,w.a.get(t.localhostProxy("https://".concat(t.bucket,".s3.amazonaws.com/").concat(t.groupFile)));case 10:n=e.sent,t.groupReport=n.data;case 12:t.groupReport.subjects.forEach((function(t){return t["subject_session_id"]="session_id"in t?[t["subject_id"],t["session_id"]].join("_").replace(/_+$/,""):t["subject_id"]}));case 13:case"end":return e.stop()}}),e)})))()},updateSubjectReports:function(t){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function i(){var n,a,r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if("file"!==e.sourceType){i.next=8;break}return i.next=3,e.readJsonFile(e.subjectReports[t]["source"]);case 3:a=i.sent,n=a["content"],"sub-test"===a["content"]["subject_id"]&&(n["subject_id"]=t),i.next=17;break;case 8:if("s3"!==e.sourceType){i.next=16;break}return i.next=11,w.a.get(e.localhostProxy("https://".concat(e.bucket,".s3.amazonaws.com/").concat(e.subjectReports[t]["source"])));case 11:r=i.sent,n=r.data,"sub-test"===r.data["subject_id"]&&(n["subject_id"]=t),i.next=17;break;case 16:"url"===e.sourceType&&console.log("URL sources are currently not supported.");case 17:return i.abrupt("return",n);case 18:case"end":return i.stop()}}),i)})))()},localhostProxy:function(t){var e=["localhost","127.0.0.1"];if(e.includes(window.location.hostname)){var i="https://cors-anywhere.herokuapp.com/";return i+t}return t}},created:function(){this.loadFromQuery()},mounted:function(){this.filesProp&&(this.sourceType="file",this.files=this.filesProp),this.groupFileProp&&(this.sourceType="file",this.groupFile=this.groupFileProp,this.selectRootGroupFile(),this.loadGroupReport())},computed:{s3ListUrl:function(){var t="https://".concat(this.bucket,".s3.amazonaws.com/?list-type=2");return t+="&max-keys=100000&prefix=".concat(this.s3Prefix),this.localhostProxy(t)},filteredSubjects:function(){var t=this;return this.subjectFilter?this.subjectsAll.filter((function(e){return e.includes(t.subjectFilter)})):this.subjectsAll},subjectsInGroupReport:function(){return this.groupReport?this.groupReport.subjects.map((function(t){return t["subject_session_id"]})):[]},subjectFileMap:function(){var t=this;return this.files?"file"===this.sourceType?S.a.reduce(this.files,(function(e,i){return e[t.parseSubjectSession(i.name)]=i,e}),{}):"s3"===this.sourceType?S.a.reduce(this.files,(function(e,i){return e[t.parseSubjectSession(i)]=i,e}),{}):{}:{}},subjectsAll:function(){return S.a.shuffle(Object(v["a"])(new Set(Object.keys(this.subjectFileMap))))}},watch:{filesProp:{deep:!0,immediate:!0,handler:function(){this.filesProp&&(this.files=this.filesProp)}},groupFileProp:{deep:!0,immediate:!0,handler:function(){this.groupFileProp&&(this.groupFile=this.groupFileProp,this.selectRootGroupFile(),this.loadGroupReport())}},urlProp:{handler:function(){this.urlProp&&(this.url=this.urlProp,this.loadFromUrl())}},s3UriProp:{handler:function(){this.s3UriProp&&(this.s3Uri=this.s3UriProp,this.loadFromS3())}},$route:"loadFromQuery",showStudyQc:{handler:function(){this.showStudyQc&&(this.subjectSelected=null)}},subjectSelected:{handler:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.subjectSelected){t.next=7;break}return this.reportReady=!1,this.showStudyQc=!1,t.next=5,this.updateSubjectReports(this.subjectSelected);case 5:this.selectedSubjectReport=t.sent,this.reportReady=!0;case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},subjectFileMap:{deep:!0,immediate:!0,handler:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.initSubjectReports(this.subjectFileMap);case 2:return this.subjectReports=t.sent,t.next=5,this.initSubjectRatings(this.subjectFileMap);case 5:this.subjectRatings=t.sent;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},props:{filesProp:Array,groupFileProp:Array,urlProp:String,s3UriProp:String}},me=pe,be=Object(c["a"])(me,b,f,!1,null,"6cf62094",null),fe=be.exports,ge={name:"LandingPage",components:{genReport:fe,spinner:V},data:function(){return{files:null,reportFiles:null,groupReportFiles:null,msg:"Welcome to dmriprep-viewer",report:{},url:null,state:"getInput"}},methods:{navigate:function(){this.url.startsWith("s3://")?this.s3():this.followUrl()},followUrl:function(){ye.push({path:"/report",query:{url:this.url}})},s3:function(){ye.push({path:"/report",query:{s3Uri:this.url.replace("s3://","")}})}},watch:{files:function(){this.files&&(this.state="showLoader",this.reportFiles=this.files.filter((function(t){return t.name.endsWith("_dwiqc.json")})),this.groupReportFiles=this.files.filter((function(t){return"dwiqc.json"===t.name})),this.state="showReports")}}},ve=ge,xe=(i("aacc"),Object(c["a"])(ve,p,m,!1,null,"7cd77cb5",null)),we=xe.exports;n["default"].use(d["a"]);var ye=new d["a"]({routes:[{path:"/",name:"LandingPage",component:we},{path:"/report",name:"GenReport",component:fe}]}),Se=!1;n["default"].config.productionTip=!1,n["default"].config.performance=Se,new n["default"]({el:"#app",router:ye,components:{App:h},template:"<App/>"})},5880:function(t,e,i){},6244:function(t,e,i){"use strict";i("5880")},"7f9d":function(t,e,i){},"85ec":function(t,e,i){},"95a3":function(t,e,i){},9784:function(t,e,i){"use strict";i("4405")},"9b07":function(t,e,i){"use strict";i("95a3")},"9b9e":function(t,e,i){},a324:function(t,e,i){},aacc:function(t,e,i){"use strict";i("7f9d")},b8a2:function(t,e,i){"use strict";i("53bd")},c803:function(t,e,i){},ed29:function(t,e,i){},eeb0:function(t,e,i){"use strict";i("9b9e")},f968:function(t,e,i){"use strict";i("a324")}});
//# sourceMappingURL=app.a3b1dfba.js.map